<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.moa.youthpolicy.wish.mapper.WishMapper">
  	
  	<select id="getWish" resultType="com.moa.youthpolicy.wish.domain.WishVO" parameterType="com.moa.youthpolicy.wish.domain.WishVO">
	    SELECT * FROM wish
	    WHERE wishUser LIKE #{wishUser} AND wishPolicy LIKE #{wishPolicy}
	</select>
	
	<!-- delWish -->
	<delete id="delWish" parameterType="com.moa.youthpolicy.wish.domain.WishVO">
	    DELETE FROM wish
	    WHERE wishUser = #{wishUser} AND wishPolicy = #{wishPolicy}
	</delete>
	
	<!-- addWish -->
	<insert id="addWish" parameterType="com.moa.youthpolicy.wish.domain.WishVO">
	    INSERT INTO wish (wishUser, wishPolicy)
	    VALUES (#{wishUser}, #{wishPolicy})
	</insert>
  
	<select id="wishList" resultType="com.moa.youthpolicy.policy.domain.PolicyVO" parameterType="com.moa.youthpolicy.policy.domain.PolicyVO">
	   SELECT policy.* FROM policy
	   
		JOIN wish ON policy.no = wish.wishPolicy
		
	</select>

	<select id="getfiveboard" resultType="com.moa.youthpolicy.policy.domain.PolicyVO">
		SELECT policy.* FROM policy
		JOIN wish ON policy.no = wish.wishPolicy
		ORDER BY no DESC LIMIT 5
	</select>
	
	<select id="getTotalCount" resultType="int" parameterType="com.moa.youthpolicy.common.Criteria">
	    SELECT COUNT(wishPolicy) FROM wish
	    WHERE wishPolicy > 0
	
	</select>
	
		<select id="getListWithPasing" resultType="com.moa.youthpolicy.policy.domain.PolicyVO" parameterType="com.moa.youthpolicy.common.Criteria">
		    SELECT * FROM policy
		    WHERE no > 0
		    <if test="type != null and keyword != null and keyword != ''">
		        <choose>
		            <when test='type == "TC"'>
		                AND (policyNm LIKE CONCAT('%', #{keyword}, '%') OR policyCn LIKE CONCAT('%', #{keyword}, '%'))
		            </when>
		            <when test='type == "T"'>
		                AND policyNm LIKE CONCAT('%', #{keyword}, '%')
		            </when>
		            <when test='type == "C"'>
		                AND policyCn LIKE CONCAT('%', #{keyword}, '%')
		            </when>
		        </choose>
		    </if>
		    <if test="rgnSeNm != null and rgnSeNm != ''">
		        AND rgnSeNm LIKE CONCAT('%', #{rgnSeNm}, '%')
		    </if>
		    <if test="policyTypeNm != null and policyTypeNm != ''">
		        AND policyTypeNm LIKE CONCAT('%', #{policyTypeNm}, '%')
		    </if>
		    <if test="selectedFilter == 'applyDate'">
		        AND aplyPsbltyYn = 'Y'
		    </if>
		    <if test="selectedFilter == 'overDate'">
		        AND aplyPsbltyYn = 'N'
		    </if>
		    ORDER BY
		    <choose>
		        <when test="selectedFilter == 'like'">
		            `like` DESC, policy.no DESC
		        </when>
		        <otherwise>
		            policy.no DESC
		        </otherwise>
		    </choose>
		    LIMIT #{start}, #{amount}
	</select>
	
  
  </mapper>